<!DOCTYPE html>
<html>


<!-- Mirrored from www.zi-han.net/theme/hplus/index_v1.html?v=4.0 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 20 Jan 2016 14:20:20 GMT -->

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--360浏览器优先以webkit内核解析-->


    <title>首页</title>

    <link href="css/bootstrap.min14ed.css?v=3.3.6" rel="stylesheet">
    <link href="css/font-awesome.min93e3.css?v=4.4.0" rel="stylesheet">

    <link rel="stylesheet" href="css/plugins/bootstrap-table/bootstrap-table.min.css">
    <link href="css/style.min862f.css?v=4.1.0" rel="stylesheet">


</head>

<body class="gray-bg">

    <div class="userTable">
        <table id="userTable"></table>
    </div>

    <script src="js/jquery.min.js?v=2.1.4"></script>
    <script src="js/bootstrap.min.js?v=3.3.6"></script>
    <script src="js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
    <script src="js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
    <script src="js/main.js"></script>
    <script>
        $(function () {
            init();
            var oTable = new TableInit();
            oTable.Init();

        })
        var columns1 = [
            {
                field: 'cusId',
                title: '客户ID',
            },
            {
                field: 'cusName',
                title: '客户姓名',

            },
            {
                field: 'cusSourceStr',
                title: '客户来源',

            },
            {
                field: 'cusMobile',
                title: '客户办公电话',

            },
            {
                field: 'cusEmail',
                title: '客户邮箱',

            },
            {
                field: 'cusLevel',
                title: '客户级别',

            }];
        var TableInit = function () {
            var oTableInit = new Object();
            //初始化Table
            oTableInit.Init = function (ele, data) {
                $('#userTable').bootstrapTable({
                    method: 'post',
                    contentType: "application/json",//必须要有！！！！
                    url: "http://116.196.89.56:8080/qiuxx-crm-restapi/crm/10010/500",//要请求数据的文件路径
                    toolbar: '#toolbar',                //工具按钮用哪个容器
                    striped: true,                      //是否显示行间隔色
                    cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
                    dataField: "data",
                    classes: 'table',
                    pagination: true,                   //是否显示分页（*）
                    sortable: false,                     //是否启用排序
                    sortOrder: "asc",                   //排序方式
                    queryParams: oTableInit.queryParams,//传递参数（*）
                    sidePagination: "server",           //分页方式：client客户端分页，server服务端分页（*）
                    pageNumber: 1,                       //初始化加载第一页，默认第一页
                    pageSize: 5,                       //每页的记录行数（*）
                    pageList: [5, 10, 15, 20],        //可供选择的每页的行数（*）
                    //search: true,                       //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大

                    clickToSelect: true,                //是否启用点击选中行

                    cardView: false,                    //是否显示详细视图
                    detailView: false,                   //是否显示父子表
                    columns: columns1,
                    responseHandler: function (res) {
                        //在ajax获取到数据，渲染表格之前，修改数据源
                        console.log(res)

                        return {
                            total: res.data.total, //总页数,前面的key必须为"total"
                            data: res.data.list//行数据，前面的key要与之前设置的dataField的值一致.
                        };
                    }
                });
            };

            //得到查询的参数
            oTableInit.queryParams = function (params) {
                var data = {
                    pageSize: params.limit, //每一页的数据行数，默认是上面设置的10(pageSize)
                    pageNum: params.offset, //当前页面,默认是上面设置的1(pageNumber)
                    //这里是其他的参数，根据自己的需求定义，可以是多个
                }
                console.log(data)
                return data
            };
            return oTableInit;
        };

        function actionFormatter(value, row, index) {
            return '<button data-openid="' + row.openid + '" class="view">查看</button>';
        }
        //表格  - 操作 - 事件
        window.actionEvents = {
            'click .view': function (e, value, row, index) {

                getDetail($(this).attr('data-openid'))
                layer.open({
                    type: 1,
                    title: '用户消费详情',
                    shadeClose: true,
                    content: $(".userpayDetail"),
                    area: ['600px', '380px'],
                })
            },
        }

        function init() {
            var url = 'crm/10010/500';
            var data = {
                pageNum: 1,
                pageSize: 5
            }
            var doSuccess = function (res) {

                // var oTable = new TableInit();
                // oTable.Init(res.result);


            }
            // $.post(url, data, function (res) {
            //     consoele.log(res)
            // })
            ajaxRequest(url, data, doSuccess)
        }
    </script>
</body>


<!-- Mirrored from www.zi-han.net/theme/hplus/index_v1.html?v=4.0 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 20 Jan 2016 14:20:20 GMT -->

</html>
